(function(){"use strict";var e={167:function(e,t,s){Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var r=_interopRequireDefault(s(147));var a=_interopRequireDefault(s(17));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const readFileSync=e=>r.default.readFileSync(e,"utf8");const pathExists=e=>new Promise((t=>{r.default.access(e,(e=>{t(!e)}))}));const o=r.default.existsSync;class JoyCon{constructor({files:e,cwd:t=process.cwd(),stopDir:s,packageKey:r,parseJSON:a=JSON.parse}={}){this.options={files:e,cwd:t,stopDir:s,packageKey:r,parseJSON:a};this.existsCache=new Map;this.loaders=new Set;this.packageJsonCache=new Map;this.loadCache=new Map}addLoader(e){this.loaders.add(e);return this}removeLoader(e){for(const t of this.loaders){if(e&&t.name===e){this.loaders.delete(t)}}return this}async recusivelyResolve(e){if(e.cwd===e.stopDir||a.default.basename(e.cwd)==="node_modules"){return null}for(const t of e.files){const s=a.default.resolve(e.cwd,t);const r=process.env.NODE_ENV!=="test"&&this.existsCache.has(s)?this.existsCache.get(s):await pathExists(s);this.existsCache.set(s,r);if(r){if(!e.packageKey||a.default.basename(s)!=="package.json"){return s}const t=require(s);delete require.cache[s];const r=Object.prototype.hasOwnProperty.call(t,e.packageKey);if(r){this.packageJsonCache.set(s,t);return s}}continue}return this.recusivelyResolve(Object.assign({},e,{cwd:a.default.dirname(e.cwd)}))}recusivelyResolveSync(e){if(e.cwd===e.stopDir||a.default.basename(e.cwd)==="node_modules"){return null}for(const t of e.files){const s=a.default.resolve(e.cwd,t);const r=process.env.NODE_ENV!=="test"&&this.existsCache.has(s)?this.existsCache.get(s):o(s);this.existsCache.set(s,r);if(r){if(!e.packageKey||a.default.basename(s)!=="package.json"){return s}const t=require(s);delete require.cache[s];const r=Object.prototype.hasOwnProperty.call(t,e.packageKey);if(r){this.packageJsonCache.set(s,t);return s}}continue}return this.recusivelyResolveSync(Object.assign({},e,{cwd:a.default.dirname(e.cwd)}))}async resolve(...e){const t=this.normalizeOptions(e);return this.recusivelyResolve(t)}resolveSync(...e){const t=this.normalizeOptions(e);return this.recusivelyResolveSync(t)}runLoaderSync(e,t){return e.loadSync(t)}runLoader(e,t){if(!e.load)return e.loadSync(t);return e.load(t)}async load(...e){const t=this.normalizeOptions(e);const s=await this.recusivelyResolve(t);if(s){const e={test:/\.+/,loadSync:e=>{const s=a.default.extname(e).slice(1);if(s==="js"||s==="cjs"){delete require.cache[e];return require(e)}if(this.packageJsonCache.has(e)){return this.packageJsonCache.get(e)[t.packageKey]}const r=this.options.parseJSON(readFileSync(e));return r}};const r=this.findLoader(s)||e;let o;if(this.loadCache.has(s)){o=this.loadCache.get(s)}else{o=await this.runLoader(r,s);this.loadCache.set(s,o)}return{path:s,data:o}}return{}}loadSync(...e){const t=this.normalizeOptions(e);const s=this.recusivelyResolveSync(t);if(s){const e={test:/\.+/,loadSync:e=>{const s=a.default.extname(e).slice(1);if(s==="js"||s==="cjs"){delete require.cache[e];return require(e)}if(this.packageJsonCache.has(e)){return this.packageJsonCache.get(e)[t.packageKey]}const r=this.options.parseJSON(readFileSync(e));return r}};const r=this.findLoader(s)||e;let o;if(this.loadCache.has(s)){o=this.loadCache.get(s)}else{o=this.runLoaderSync(r,s);this.loadCache.set(s,o)}return{path:s,data:o}}return{}}findLoader(e){for(const t of this.loaders){if(t.test&&t.test.test(e)){return t}}return null}clearCache(){this.existsCache.clear();this.packageJsonCache.clear();this.loadCache.clear();return this}normalizeOptions(e){const t=Object.assign({},this.options);if(Object.prototype.toString.call(e[0])==="[object Object]"){Object.assign(t,e[0])}else{if(e[0]){t.files=e[0]}if(e[1]){t.cwd=e[1]}if(e[2]){t.stopDir=e[2]}}t.cwd=a.default.resolve(t.cwd);t.stopDir=t.stopDir?a.default.resolve(t.stopDir):a.default.parse(t.cwd).root;if(!t.files||t.files.length===0){throw new Error("[joycon] files must be an non-empty array!")}t.__normalized__=true;return t}}t["default"]=JoyCon;e.exports=JoyCon;e.exports["default"]=JoyCon},147:function(e){e.exports=require("fs")},17:function(e){e.exports=require("path")}};var t={};function __nccwpck_require__(s){var r=t[s];if(r!==undefined){return r.exports}var a=t[s]={exports:{}};var o=true;try{e[s](a,a.exports,__nccwpck_require__);o=false}finally{if(o)delete t[s]}return a.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var s=__nccwpck_require__(167);module.exports=s})();